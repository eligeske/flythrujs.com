var flythru=function(){var t=($("#test_panel"),$("#speciman")),n=$("#reset"),e=[],a=!1,i={win:null},s=!1,o={viewport:{h:800,w:900},zoom:1,pace:1e3},r=function(){t.css({height:o.viewport.h+"px",width:o.viewport.w+"px",transform:"scale("+o.zoom+")"}),o.zoom<1&&t.css({transform:"scale("+o.zoom+")"});var n=($("#right_cont").width()-t.width()*o.zoom)/2,e=($("#right_cont").height()-t.height()*o.zoom)/2;$("#browser_window").css({"padding-left":n>0?n:0,"padding-top":e>0?e:0})};$(window).resize(function(){r()});var d=$("#run_test").click(function(){l.start()});d.attr("disabled",!0),setTimeout(function(){d.removeAttr("disabled",!0)},1),n.click(function(){l.reset()});var l=function(){var t=0,a={start:function(){s=!1,n.attr("disabled",!0);var i=function(){s||(e[t]?(e[t-1]&&e[t-1].expand(!1),e[t].expand(!0),e[t].arrival(function(){t++,i(t)}),e[t].takeoff()):(a.stop(),d.text("Landed!").attr("disabled",!0)))};i()},stop:function(){s=!0,n.removeAttr("disabled"),d.text("Take Off").removeAttr("disabled")},reset:function(){a.stop(),window.location.reload()}};return a}(),c=function(){i.win=t[0].contentWindow?t[0].contentWindow:!1,i.toolbox={angular:{applyValue:function(t,n){if(!i.win.angular)throw"Angular is not defined";var e=$(t).attr("ng-model");e&&i.win.angular&&i.win.angular.element(t).scope&&(i.win.angular.element(t).scope()[e]=n,i.win.angular.element(t).scope().$apply())}}}},u=function(t){var n=this,e=[],a=0,r={};n.completedCallbacks=[],this.reset=function(){a=0,d.removeClass("passed").removeClass("failed"),c.find("div").removeClass("passed").removeClass("failed"),n.expand(!1)};var d=$("<div>",{"class":"group"}),l=$("<span>",{"class":"title",html:t}),c=$("<div>",{"class":"check-holder"});this.expand=function(t){t?d.addClass("open"):d.removeClass("open")},d.append(l,c),l.click(function(){n.expand(!$(this).parent().find(".check-holder").is(":visible"))}),$("#test_panel").append(d);var u=function(){if(!s)if(e[a]){a++;var t=e[a-1];setTimeout(t,(ms=r[(a-1).toString()])?ms:o.pace)}else d.hasClass("failed")||(d.addClass("passed"),$.each(n.completedCallbacks,function(t,n){n()}))};this.flyby=function(){return n},this.addStop=function(t,a){var s=$("<div>",{html:"<span>"+t+"</span>","class":"check"});return c.append(s),e.push(function(){a(function(){s.addClass("passed"),u()},function(t){s.addClass("failed"),d.addClass("failed"),t&&alert(t)},i)}),n};var f=function(t,n,a){var s=$("<div>",{html:"<span>"+t+"</span>","class":"check"});c.append(s);var a=a,n=n;e.push(function(){var t=null,e=0,o=1e3,r=function(n){t=!1,s.addClass("failed"),d.addClass("failed"),n&&alert(n)},l=function(){return null!==t?void(t?u():r("Layover times up")):void setTimeout(function(){e+=o,n(function(){t=!0,s.addClass("passed")},r,i),e>a&&(t=!1),l()},1e3)};l()})};this.layover=function(t,a,i){return arguments.length>1?f(t,a,i):r[e.length.toString()]=t,n},this.takeoff=function(){u()},this.arrival=function(t){n.completedCallbacks.push(t)},this.stops=e},f={destination:function(n){var i=new u("Load web page");return e.push(i),i.addStop("Navigate to: "+n,function(e){d.attr("disabled",!0),d.text("boarding.."),t.load(function(){t.removeClass("faded"),setTimeout(function(){c(),a=!0,d.text("In Flight!"),e()},2e3)}),t.attr("src",n)}),f},addFlight:function(t){var n=new u(t);return e.push(n),n},getConfig:function(){return o},config:function(t){$.extend(o,t),r()},cargo:i,flights:e};return r(),f}();
